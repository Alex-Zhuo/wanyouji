# Generated by Django 3.0 on 2025-11-19 16:11

import blind_box.models
import common.utils
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import mall.utils


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('coupon', '0024_auto_20251119_1539'),
        ('mp', '0004_auto_20250902_1746'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BlindBasic',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('price_per_lottery', models.DecimalField(decimal_places=2, max_digits=13, verbose_name='一次抽奖机会价格')),
                ('auto_cancel_minutes', models.PositiveSmallIntegerField(default=5, editable=False, help_text='订单创建时间开始多少分钟后未支付自动取消订单', validators=[blind_box.models.cancel_minutes_limit], verbose_name='自动取消盲盒订单分钟数')),
            ],
            options={
                'verbose_name': '盲盒转盘配置',
                'verbose_name_plural': '盲盒转盘配置',
            },
        ),
        migrations.CreateModel(
            name='BlindBox',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=common.utils.get_no, max_length=64, null=True, unique=True, verbose_name='编号')),
                ('title', models.CharField(max_length=128, verbose_name='名称')),
                ('status', models.IntegerField(choices=[(2, '下架'), (1, '上架')], default=1, help_text='下架后则不会被抽中', verbose_name='状态')),
                ('grids_num', models.PositiveSmallIntegerField(choices=[(3, '3格'), (6, '6格'), (9, '9格')], default=3, verbose_name='格子数')),
                ('type', models.PositiveSmallIntegerField(choices=[(1, '普通'), (2, '稀有'), (3, '隐藏')], default=1, verbose_name='类型')),
                ('price', models.DecimalField(decimal_places=2, default=0, max_digits=13, verbose_name='价格')),
                ('original_price', models.DecimalField(decimal_places=2, default=0, max_digits=13, verbose_name='原价')),
                ('stock', models.IntegerField(default=0, verbose_name='盲盒库存数量')),
                ('desc', models.TextField(help_text='副标题的意思', max_length=1000, verbose_name='描述说明')),
                ('rare_weight_multiple', models.PositiveSmallIntegerField(default=1, verbose_name='稀有款权重倍数')),
                ('hidden_weight_multiple', models.PositiveSmallIntegerField(default=1, verbose_name='隐藏款权重倍数')),
                ('logo', models.ImageField(upload_to='images/blind/box', validators=[django.core.validators.validate_image_file_extension], verbose_name='盲盒封面图')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
            ],
            options={
                'verbose_name': '盲盒',
                'verbose_name_plural': '盲盒',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='BlindBoxOrder',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_no', models.CharField(db_index=True, default=blind_box.models.price_his_no, max_length=128, unique=True, verbose_name='订单号')),
                ('mobile', models.CharField(max_length=20, verbose_name='手机号')),
                ('status', models.PositiveSmallIntegerField(choices=[(1, '未付款'), (2, '已支付'), (3, '已取消'), (4, '退款中'), (5, '已退款')], default=1, verbose_name='状态')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='实付金额')),
                ('refund_amount', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='已退款金额')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('pay_at', models.DateTimeField(blank=True, null=True, verbose_name='支付时间')),
                ('refund_at', models.DateTimeField(blank=True, null=True, verbose_name='退款完成时间')),
                ('transaction_id', models.CharField(blank=True, max_length=100, null=True, verbose_name='交易号')),
                ('snapshot', models.TextField(editable=False, help_text='下单时保存的快照', verbose_name='盲盒快照')),
                ('pay_end_at', models.DateTimeField(null=True, verbose_name='支付截止时间')),
                ('blind_box', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.BlindBox', verbose_name='盲盒')),
            ],
            options={
                'verbose_name': '盲盒订单',
                'verbose_name_plural': '盲盒订单',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='BlindReceipt',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('update_at', models.DateTimeField(auto_now=True, verbose_name='更新时间')),
                ('payno', models.CharField(db_index=True, default=mall.utils.randomstrwithdatetime, max_length=100, verbose_name='商户订单号')),
                ('amount', models.DecimalField(decimal_places=2, default=0.0, max_digits=13, verbose_name='实付金额')),
                ('status', models.IntegerField(choices=[(0, '未付款'), (1, '已付款')], default=0, verbose_name='状态')),
                ('pay_type', models.SmallIntegerField(choices=[(-1, '空'), (7, '微信小程序支付')], default=-1, verbose_name='付款类型')),
                ('sign', models.CharField(blank=True, max_length=32, null=True, verbose_name='微信支付签名')),
                ('transaction_id', models.CharField(blank=True, max_length=32, null=True, verbose_name='微信支付单号')),
                ('prepay_id', models.CharField(blank=True, max_length=100, null=True, verbose_name='微信支付预支付订单号')),
                ('biz', models.SmallIntegerField(choices=[(1, '盲盒订单'), (2, '转盘订单')], default=1, verbose_name='业务类型')),
                ('attachment', models.TextField(blank=True, help_text='请勿修改此字段', null=True, verbose_name='附加数据')),
                ('pay_end_at', models.DateTimeField(null=True, verbose_name='支付截止时间')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户')),
                ('wx_pay_config', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='mp.WeiXinPayConfig', verbose_name='微信支付')),
            ],
            options={
                'verbose_name': '支付记录',
                'verbose_name_plural': '支付记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='Prize',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=common.utils.get_no, max_length=64, null=True, unique=True, verbose_name='编号')),
                ('title', models.CharField(max_length=128, verbose_name='名称')),
                ('status', models.IntegerField(choices=[(2, '下架'), (1, '上架')], default=1, help_text='下架后则不会被抽中', verbose_name='状态')),
                ('source_type', models.PositiveSmallIntegerField(choices=[(1, '消费券'), (2, '纸质票'), (3, '券码'), (4, '实物奖品')], default=1, verbose_name='奖品类型')),
                ('rare_type', models.PositiveSmallIntegerField(choices=[(1, '普通款'), (2, '稀有款'), (3, '隐藏款')], default=1, verbose_name='稀有类型')),
                ('amount', models.DecimalField(decimal_places=2, default=0, max_digits=13, verbose_name='价值')),
                ('desc', models.TextField(max_length=1000, verbose_name='描述')),
                ('instruction', models.TextField(verbose_name='兑奖说明')),
                ('stock', models.IntegerField(default=0, verbose_name='库存数量')),
                ('weight', models.PositiveSmallIntegerField(default=0, verbose_name='权重数')),
                ('head_image', models.ImageField(blank=True, null=True, upload_to='images/blind/prize/head', validators=[django.core.validators.validate_image_file_extension], verbose_name='奖品头图')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('coupon', models.ForeignKey(blank=True, help_text='消费卷类型时选填', null=True, on_delete=django.db.models.deletion.SET_NULL, to='coupon.Coupon', verbose_name='消费卷')),
            ],
            options={
                'verbose_name': '奖品',
                'verbose_name_plural': '奖品',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='UserLotteryRecord',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=blind_box.models.price_his_no, editable=False, max_length=128, unique=True, verbose_name='编号')),
                ('mobile', models.CharField(max_length=20, null=True, verbose_name='手机号')),
                ('is_prize', models.BooleanField(default=False, verbose_name='是否中奖')),
                ('snapshot', models.TextField(editable=False, help_text='下单时保存的快照', verbose_name='转盘快照')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('user', models.OneToOneField(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户')),
            ],
            options={
                'verbose_name': '用户转盘抽奖记录',
                'verbose_name_plural': '用户转盘抽奖记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='WheelActivity',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=common.utils.get_no, max_length=64, null=True, unique=True, verbose_name='编号')),
                ('name', models.CharField(max_length=128, verbose_name='名称')),
                ('status', models.PositiveSmallIntegerField(choices=[(2, '下架'), (1, '上架')], default=1, help_text='最多一个上架', verbose_name='状态')),
                ('description', models.TextField(blank=True, verbose_name='活动说明')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
            ],
            options={
                'verbose_name': '转盘活动',
                'verbose_name_plural': '转盘活动',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='WinningRecordShipmentReceipt',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('receipt_file', models.FileField(help_text='只支持xlsx', upload_to='files/blind/shipment_receipt', validators=[django.core.validators.FileExtensionValidator(allowed_extensions=['xlsx'])], verbose_name='回执文件')),
                ('remark', models.TextField(blank=True, verbose_name='备注')),
                ('operator', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='操作用户')),
            ],
            options={
                'verbose_name': '中奖记录发货回执',
                'verbose_name_plural': '中奖记录发货回执',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='WheelWinningRecord',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=blind_box.models.winning_record_no, editable=False, max_length=128, unique=True, verbose_name='中奖序号')),
                ('mobile', models.CharField(max_length=20, verbose_name='手机号')),
                ('express_address', models.CharField(blank=True, max_length=200, null=True, verbose_name='送货地址')),
                ('express_phone', models.CharField(blank=True, max_length=11, null=True, verbose_name='收货联系人电话')),
                ('express_user_name', models.CharField(blank=True, max_length=11, null=True, verbose_name='收货姓名')),
                ('source_type', models.PositiveSmallIntegerField(choices=[(1, '消费券'), (2, '纸质票'), (3, '券码'), (4, '实物奖品')], default=1, verbose_name='奖品类型')),
                ('remark', models.TextField(blank=True, max_length=1000, null=True, verbose_name='备注')),
                ('status', models.PositiveSmallIntegerField(choices=[(1, '未付款'), (2, '待领取'), (3, '待发货'), (4, '待收货'), (5, '已完成'), (6, '无效')], default=2, verbose_name='状态')),
                ('express_no', models.CharField(blank=True, max_length=50, null=True, verbose_name='快递单号')),
                ('express_company_code', models.CharField(blank=True, max_length=30, null=True, verbose_name='快递公司编码')),
                ('express_company_name', models.CharField(blank=True, max_length=50, null=True, verbose_name='快递公司')),
                ('winning_at', models.DateTimeField(auto_now_add=True, verbose_name='中奖时间')),
                ('receive_at', models.DateTimeField(blank=True, null=True, verbose_name='领取时间')),
                ('ship_at', models.DateTimeField(blank=True, null=True, verbose_name='发货时间')),
                ('complete_at', models.DateTimeField(blank=True, null=True, verbose_name='完成时间')),
                ('snapshot', models.TextField(editable=False, help_text='中奖时保存的快照', verbose_name='奖品快照')),
                ('wheel_name', models.CharField(max_length=128, verbose_name='转盘名称')),
                ('lottery_record', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lottery_items', to='blind_box.UserLotteryRecord', verbose_name='转盘抽奖记录')),
                ('prize', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.Prize', verbose_name='奖品')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='中奖用户')),
                ('wheel_activity', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.WheelActivity', verbose_name='转盘活动')),
            ],
            options={
                'verbose_name': '转盘中奖记录',
                'verbose_name_plural': '转盘中奖记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='WheelSection',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=common.utils.get_no, max_length=64, null=True, unique=True, verbose_name='编号')),
                ('is_no_prize', models.BooleanField(default=False, help_text='勾选后则该片区不中奖', verbose_name='是否谢谢参与')),
                ('weight', models.PositiveSmallIntegerField(default=0, verbose_name='权重数')),
                ('winning_tip', models.CharField(blank=True, max_length=200, verbose_name='中奖提示语')),
                ('is_enabled', models.BooleanField(default=True, help_text='不勾选时转盘不显示该片区，计算概率时不看该片区', verbose_name='是否启用')),
                ('prize', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.Prize', verbose_name='关联奖品')),
                ('wheel_activity', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='sections', to='blind_box.WheelActivity', verbose_name='转盘活动')),
            ],
            options={
                'verbose_name': '转盘片区',
                'verbose_name_plural': '转盘片区',
                'ordering': ['pk'],
            },
        ),
        migrations.CreateModel(
            name='UserLotteryTimes',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('mobile', models.CharField(max_length=20, null=True, verbose_name='手机号')),
                ('times', models.IntegerField(default=0, verbose_name='剩余转盘次数')),
                ('total_times', models.IntegerField(default=0, verbose_name='总转盘次数')),
                ('version', models.PositiveIntegerField(default=0, editable=False, verbose_name='版本')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('update_at', models.DateTimeField(blank=True, null=True, verbose_name='更新时间')),
                ('user', models.OneToOneField(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户')),
            ],
            options={
                'verbose_name': '用户转盘次数',
                'verbose_name_plural': '用户转盘次数',
                'ordering': ['-pk'],
            },
        ),
        migrations.AddField(
            model_name='userlotteryrecord',
            name='wheel_activity',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.WheelActivity', verbose_name='转盘活动'),
        ),
        migrations.CreateModel(
            name='PrizeDetailImage',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('image', models.ImageField(upload_to='images/blind/prize/detail', validators=[django.core.validators.validate_image_file_extension], verbose_name='图片')),
                ('prize', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detail_images', to='blind_box.Prize', verbose_name='奖品')),
            ],
            options={
                'verbose_name': '奖品详情图',
                'verbose_name_plural': '奖品详情图',
                'ordering': ['pk'],
            },
        ),
        migrations.CreateModel(
            name='LotteryPurchaseRecord',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_no', models.CharField(db_index=True, default=blind_box.models.lottery_purchase_order_no, max_length=128, unique=True, verbose_name='订单号')),
                ('mobile', models.CharField(max_length=20, verbose_name='手机号')),
                ('purchase_count', models.PositiveIntegerField(verbose_name='购买次数')),
                ('amount', models.DecimalField(decimal_places=2, max_digits=13, verbose_name='实付金额')),
                ('refund_amount', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='已退款金额')),
                ('status', models.PositiveSmallIntegerField(choices=[(1, '未支付'), (2, '已付款'), (3, '已取消'), (4, '退款中'), (5, '已退款')], default=2, verbose_name='状态')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='下单时间')),
                ('pay_at', models.DateTimeField(blank=True, null=True, verbose_name='支付时间')),
                ('refund_at', models.DateTimeField(blank=True, null=True, verbose_name='退款完成时间')),
                ('cancel_at', models.DateTimeField(blank=True, null=True, verbose_name='取消时间')),
                ('snapshot', models.TextField(editable=False, help_text='下单时保存的快照', verbose_name='转盘快照')),
                ('transaction_id', models.CharField(blank=True, max_length=32, null=True, verbose_name='微信支付单号')),
                ('receipt', models.OneToOneField(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lottery_receipt', to='blind_box.BlindReceipt', verbose_name='收款记录')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户')),
            ],
            options={
                'verbose_name': '抽奖次数购买记录',
                'verbose_name_plural': '抽奖次数购买记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='BlindOrderRefund',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('source_type', models.PositiveSmallIntegerField(choices=[(1, '盲盒订单'), (2, '转盘次数')], default=1, verbose_name='订单类型')),
                ('order_no', models.CharField(max_length=128, verbose_name='订单号')),
                ('out_refund_no', models.CharField(db_index=True, default=blind_box.models.blind_refund_no, max_length=64, unique=True, verbose_name='退款单号')),
                ('status', models.IntegerField(choices=[(1, '待退款'), (2, '退款支付中'), (3, '退款支付失败'), (4, '已完成'), (5, '已拒绝')], default=1, verbose_name='状态')),
                ('refund_amount', models.DecimalField(decimal_places=2, default=0, max_digits=13, verbose_name='退款金额')),
                ('refund_reason', models.CharField(blank=True, max_length=200, null=True, verbose_name='退款原因')),
                ('amount', models.DecimalField(decimal_places=2, default=0, max_digits=13, verbose_name='实退金额')),
                ('error_msg', models.CharField(blank=True, max_length=1000, null=True, verbose_name='退款返回信息')),
                ('transaction_id', models.CharField(blank=True, max_length=100, null=True, verbose_name='交易号')),
                ('refund_id', models.CharField(blank=True, max_length=32, null=True, verbose_name='退款方退款单号')),
                ('return_code', models.CharField(blank=True, max_length=20, null=True, verbose_name='微信通信结果')),
                ('result_code', models.CharField(blank=True, max_length=20, null=True, verbose_name='微信返回结果')),
                ('create_at', models.DateTimeField(auto_now_add=True, verbose_name='创建时间')),
                ('confirm_at', models.DateTimeField(blank=True, null=True, verbose_name='确认时间')),
                ('finish_at', models.DateTimeField(blank=True, null=True, verbose_name='完成时间')),
                ('blind_box_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.BlindBoxOrder', verbose_name='盲盒订单')),
                ('lottery_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.LotteryPurchaseRecord', verbose_name='转盘次数购买记录')),
                ('op_user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='操作退款用户')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户')),
            ],
            options={
                'verbose_name': '退款记录',
                'verbose_name_plural': '退款记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.CreateModel(
            name='BlindBoxWinningRecord',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('no', models.CharField(db_index=True, default=blind_box.models.winning_record_no, editable=False, max_length=128, unique=True, verbose_name='中奖序号')),
                ('mobile', models.CharField(max_length=20, verbose_name='手机号')),
                ('express_address', models.CharField(blank=True, max_length=200, null=True, verbose_name='送货地址')),
                ('express_phone', models.CharField(blank=True, max_length=11, null=True, verbose_name='收货联系人电话')),
                ('express_user_name', models.CharField(blank=True, max_length=11, null=True, verbose_name='收货姓名')),
                ('source_type', models.PositiveSmallIntegerField(choices=[(1, '消费券'), (2, '纸质票'), (3, '券码'), (4, '实物奖品')], default=1, verbose_name='奖品类型')),
                ('remark', models.TextField(blank=True, max_length=1000, null=True, verbose_name='备注')),
                ('status', models.PositiveSmallIntegerField(choices=[(1, '未付款'), (2, '待领取'), (3, '待发货'), (4, '待收货'), (5, '已完成'), (6, '无效')], default=2, verbose_name='状态')),
                ('express_no', models.CharField(blank=True, max_length=50, null=True, verbose_name='快递单号')),
                ('express_company_code', models.CharField(blank=True, max_length=30, null=True, verbose_name='快递公司编码')),
                ('express_company_name', models.CharField(blank=True, max_length=50, null=True, verbose_name='快递公司')),
                ('winning_at', models.DateTimeField(auto_now_add=True, verbose_name='中奖时间')),
                ('receive_at', models.DateTimeField(blank=True, null=True, verbose_name='领取时间')),
                ('ship_at', models.DateTimeField(blank=True, null=True, verbose_name='发货时间')),
                ('complete_at', models.DateTimeField(blank=True, null=True, verbose_name='完成时间')),
                ('snapshot', models.TextField(editable=False, help_text='中奖时保存的快照', verbose_name='奖品快照')),
                ('blind_box_title', models.CharField(max_length=128, verbose_name='盲盒名称')),
                ('blind_box', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.BlindBox', verbose_name='盲盒')),
                ('blind_box_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='blind_box_items', to='blind_box.BlindBoxOrder', verbose_name='盲盒订单')),
                ('prize', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='blind_box.Prize', verbose_name='奖品')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='中奖用户')),
            ],
            options={
                'verbose_name': '转盘中奖记录',
                'verbose_name_plural': '转盘中奖记录',
                'ordering': ['-pk'],
            },
        ),
        migrations.AddField(
            model_name='blindboxorder',
            name='receipt',
            field=models.OneToOneField(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='blind_receipt', to='blind_box.BlindReceipt', verbose_name='收款记录'),
        ),
        migrations.AddField(
            model_name='blindboxorder',
            name='user',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL, verbose_name='用户'),
        ),
        migrations.AddField(
            model_name='blindboxorder',
            name='wx_pay_config',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='mp.WeiXinPayConfig', verbose_name='微信支付'),
        ),
        migrations.CreateModel(
            name='BlindBoxDetailImage',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('image', models.ImageField(upload_to='images/blind/box/detail', validators=[django.core.validators.validate_image_file_extension], verbose_name='图片')),
                ('blind_box', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detail_images', to='blind_box.BlindBox', verbose_name='盲盒')),
            ],
            options={
                'verbose_name': '盲盒详情图',
                'verbose_name_plural': '盲盒详情图',
                'ordering': ['pk'],
            },
        ),
        migrations.CreateModel(
            name='BlindBoxCarouselImage',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('image', models.ImageField(upload_to='images/blind/box/carousel', validators=[django.core.validators.validate_image_file_extension], verbose_name='图片')),
                ('blind_box', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='carousel_images', to='blind_box.BlindBox', verbose_name='盲盒')),
            ],
            options={
                'verbose_name': '盲盒详情轮播图',
                'verbose_name_plural': '盲盒详情轮播图',
                'ordering': ['pk'],
            },
        ),
    ]
